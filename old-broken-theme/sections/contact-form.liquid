{% comment %}
  Contact Form Section
  Standard Shopify contact form with hCaptcha
{% endcomment %}

<div class="contact-form-section section">
  <div class="container{% if section.settings.narrow_container %} container--narrow{% endif %}">
    {% if section.settings.heading != blank %}
      <div class="contact-form-section__header text-center">
        <h2 class="contact-form-section__heading">{{ section.settings.heading }}</h2>
        {% if section.settings.text != blank %}
          <div class="contact-form-section__text rte">
            {{ section.settings.text }}
          </div>
        {% endif %}
      </div>
    {% endif %}

    {% form 'contact', class: 'contact-form' %}
      {% if form.posted_successfully? %}
        <div class="contact-form__success alert alert--success">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm5.293 7.707l-6 6a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414L9 11.586l5.293-5.293a1 1 0 111.414 1.414z"/>
          </svg>
          {{ section.settings.success_message }}
        </div>
      {% elsif form.errors %}
        <div class="contact-form__errors alert alert--error">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm1 14H9v-2h2v2zm0-3H9V6h2v5z"/>
          </svg>
          <strong>{{ 'contact.form.error_heading' | t | default: 'Please correct the following:' }}</strong>
          {{ form.errors | default_errors }}
        </div>
      {% endif %}

      <div class="contact-form__fields">
        <div class="form-group">
          <label for="ContactForm-name" class="form-label{% if section.settings.show_required_indicator %} form-label--required{% endif %}">
            {{ section.settings.name_label }}
          </label>
          <input
            type="text"
            id="ContactForm-name"
            name="contact[name]"
            value="{% if form.name %}{{ form.name }}{% elsif customer %}{{ customer.name }}{% endif %}"
            class="form-input"
            autocomplete="name"
            required
          >
        </div>

        <div class="form-group">
          <label for="ContactForm-email" class="form-label{% if section.settings.show_required_indicator %} form-label--required{% endif %}">
            {{ section.settings.email_label }}
          </label>
          <input
            type="email"
            id="ContactForm-email"
            name="contact[email]"
            value="{% if form.email %}{{ form.email }}{% elsif customer %}{{ customer.email }}{% endif %}"
            class="form-input"
            autocomplete="email"
            autocapitalize="off"
            autocorrect="off"
            required
          >
        </div>

        {% if section.settings.show_phone %}
          <div class="form-group">
            <label for="ContactForm-phone" class="form-label">
              {{ section.settings.phone_label }}
            </label>
            <input
              type="tel"
              id="ContactForm-phone"
              name="contact[phone]"
              value="{% if form.phone %}{{ form.phone }}{% elsif customer %}{{ customer.phone }}{% endif %}"
              class="form-input"
              autocomplete="tel"
            >
          </div>
        {% endif %}

        <div class="form-group">
          <label for="ContactForm-body" class="form-label{% if section.settings.show_required_indicator %} form-label--required{% endif %}">
            {{ section.settings.message_label }}
          </label>
          <textarea
            id="ContactForm-body"
            name="contact[body]"
            class="form-textarea"
            rows="6"
            required
          >{% if form.body %}{{ form.body }}{% endif %}</textarea>
        </div>

        <div class="form-group">
          <button type="submit" class="btn btn--primary btn--full">
            {{ section.settings.button_label }}
          </button>
        </div>
      </div>
    {% endform %}
  </div>
</div>

<style>
  .contact-form-section {
    padding: var(--spacing-4xl) 0;
    background-color: {% if section.settings.background_color == 'white' %}var(--color-white){% else %}var(--color-off-white){% endif %};
  }

  .contact-form-section__header {
    margin-bottom: var(--spacing-2xl);
  }

  .contact-form-section__heading {
    margin-bottom: var(--spacing-md);
  }

  .contact-form-section__text {
    max-width: 600px;
    margin: 0 auto;
    color: var(--color-charcoal);
  }

  .contact-form {
    max-width: 600px;
    margin: 0 auto;
  }

  .contact-form__success,
  .contact-form__errors {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    border-radius: var(--radius-md);
  }

  .contact-form__success {
    background-color: #EDF7F0;
    color: var(--color-success);
    border-left: 4px solid var(--color-success);
  }

  .contact-form__errors {
    background-color: #FDEEED;
    color: var(--color-error);
    border-left: 4px solid var(--color-error);
  }

  .contact-form__errors ul {
    margin: var(--spacing-xs) 0 0 0;
    padding-left: var(--spacing-lg);
  }

  .contact-form__errors li {
    margin-bottom: var(--spacing-xs);
  }

  .contact-form__fields {
    display: grid;
    gap: var(--spacing-lg);
  }
</style>

{% schema %}
{
  "name": "Contact Form",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Get In Touch"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Description",
      "default": "<p>Have a question or need a custom quote? Fill out the form below and we'll get back to you within 48 hours.</p>"
    },
    {
      "type": "checkbox",
      "id": "narrow_container",
      "label": "Use Narrow Container",
      "default": true
    },
    {
      "type": "select",
      "id": "background_color",
      "label": "Background Color",
      "options": [
        {
          "value": "white",
          "label": "White"
        },
        {
          "value": "off-white",
          "label": "Off-White"
        }
      ],
      "default": "off-white"
    },
    {
      "type": "header",
      "content": "Form Labels"
    },
    {
      "type": "text",
      "id": "name_label",
      "label": "Name Label",
      "default": "Name"
    },
    {
      "type": "text",
      "id": "email_label",
      "label": "Email Label",
      "default": "Email"
    },
    {
      "type": "checkbox",
      "id": "show_phone",
      "label": "Show Phone Field",
      "default": true
    },
    {
      "type": "text",
      "id": "phone_label",
      "label": "Phone Label",
      "default": "Phone Number (optional)"
    },
    {
      "type": "text",
      "id": "message_label",
      "label": "Message Label",
      "default": "Message"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "Send Message"
    },
    {
      "type": "checkbox",
      "id": "show_required_indicator",
      "label": "Show Required Field Indicator (*)",
      "default": true
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success Message",
      "default": "Thanks for contacting us. We'll get back to you as soon as possible."
    }
  ],
  "presets": [
    {
      "name": "Contact Form"
    }
  ]
}
{% endschema %}
