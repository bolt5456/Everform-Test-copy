{% comment %}
  Main Product Section - Technical Template
  For copings, window pods, technical/architectural products
  Two-column layout: Gallery + Product Info
  Followed by size charts, technical specs, accordions
{% endcomment %}

<div class="main-product main-product--technical">
  <div class="container">
    {%- comment -%}Breadcrumbs{%- endcomment -%}
    {% if section.settings.show_breadcrumbs %}
      <nav class="breadcrumbs" aria-label="Breadcrumb">
        <div class="breadcrumbs__item">
          <a href="{{ routes.root_url }}" class="breadcrumbs__link">Home</a>
          <span class="breadcrumbs__separator">/</span>
        </div>
        {% if collection %}
          <div class="breadcrumbs__item">
            <a href="{{ collection.url }}" class="breadcrumbs__link">{{ collection.title }}</a>
            <span class="breadcrumbs__separator">/</span>
          </div>
        {% endif %}
        <div class="breadcrumbs__item">
          <span class="breadcrumbs__current">{{ product.title }}</span>
        </div>
      </nav>
    {% endif %}

    <div class="main-product__grid">
      {%- comment -%}Product Gallery{%- endcomment -%}
      <div class="main-product__gallery">
        {% render 'product-gallery-section' %}
      </div>

      {%- comment -%}Product Information{%- endcomment -%}
      <div class="main-product__info">
        {% render 'product-info-section' %}
      </div>
    </div>
  </div>
</div>

{%- comment -%}Inline gallery section rendering{%- endcomment -%}
{% capture product_gallery_section %}
  {% section 'product-gallery' %}
{% endcapture %}

{%- comment -%}Inline product-info section rendering{%- endcomment -%}
{% capture product_info_section %}
  {% section 'product-info' %}
{% endcapture %}

{%- comment -%}Product schema markup with additional technical details{%- endcomment -%}
{% liquid
  assign current_variant = product.selected_or_first_available_variant
  assign brand_name = product.vendor | default: shop.name
  assign offer_price = current_variant.price | divided_by: 100.0
%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": {{ product.title | json }},
  "description": {{ product.description | strip_html | json }},
  {% if product.featured_media %}
  "image": {{ product.featured_media | image_url: width: 1200 | prepend: 'https:' | json }},
  {% endif %}
  {% if current_variant.sku != blank %}
  "sku": {{ current_variant.sku | json }},
  {% endif %}
  "brand": {
    "@type": "Brand",
    "name": {{ brand_name | json }}
  },
  "offers": {
    "@type": "Offer",
    "url": {{ shop.url | append: product.url | json }},
    "priceCurrency": {{ cart.currency.iso_code | json }},
    "price": {{ offer_price | json }},
    "availability": "{% if current_variant.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
    "itemCondition": "https://schema.org/NewCondition",
    "seller": {
      "@type": "Organization",
      "name": {{ shop.name | json }}
    }
  }{% capture additional_properties %}
    {% if product.metafields.custom.material != blank %}
      {"@type":"PropertyValue","name":"Material","value":{{ product.metafields.custom.material | json }}}
    {% endif %}
    {% if product.metafields.custom.thickness != blank %}
      {% if product.metafields.custom.material != blank %},{% endif %}
      {"@type":"PropertyValue","name":"Thickness/Gauge","value":{{ product.metafields.custom.thickness | json }}}
    {% endif %}
    {% if product.metafields.custom.warranty != blank %}
      {% if product.metafields.custom.material != blank or product.metafields.custom.thickness != blank %},{% endif %}
      {"@type":"PropertyValue","name":"Warranty","value":{{ product.metafields.custom.warranty | json }}}
    {% endif %}
    {% if product.metafields.custom.lead_time != blank %}
      {% if product.metafields.custom.material != blank or product.metafields.custom.thickness != blank or product.metafields.custom.warranty != blank %},{% endif %}
      {"@type":"PropertyValue","name":"Lead Time","value":{{ product.metafields.custom.lead_time | json }}}
    {% endif %}
  {% endcapture %}{% assign additional_properties = additional_properties | strip %}
  {% if additional_properties != blank %}
  ,"additionalProperty":[{{ additional_properties }}]
  {% endif %}
}
</script>

{%- comment -%}Breadcrumb schema markup{%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": {{ shop.url | json }}
    }{% if collection %},
    {
      "@type": "ListItem",
      "position": 2,
      "name": {{ collection.title | json }},
      "item": {{ shop.url | append: collection.url | json }}
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": {{ product.title | json }},
      "item": {{ shop.url | append: product.url | json }}
    }{% else %},
    {
      "@type": "ListItem",
      "position": 2,
      "name": {{ product.title | json }},
      "item": {{ shop.url | append: product.url | json }}
    }{% endif %}
  ]
}
</script>

<style>
  .main-product {
    padding: var(--spacing-2xl) 0;
  }

  .main-product__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-2xl);
    margin-top: var(--spacing-lg);
  }

  @media (min-width: 1024px) {
    .main-product__grid {
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-3xl);
    }
  }

  /* Technical product specific styles */
  .main-product--technical {
    background-color: var(--color-white);
  }
</style>

{% schema %}
{
  "name": "Product - Technical",
  "class": "section-product-technical",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show Breadcrumbs",
      "default": true
    }
  ]
}
{% endschema %}
