{% comment %}
  Featured Collection Section
  Displays products from a selected collection
{% endcomment %}

<div class="featured-collection section">
  <div class="container">
    {% if section.settings.heading != blank %}
      <div class="featured-collection__header">
        <h2 class="featured-collection__heading">{{ section.settings.heading }}</h2>
        {% if section.settings.description != blank %}
          <p class="featured-collection__description">{{ section.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    {% if section.settings.collection != blank %}
      {% assign collection = collections[section.settings.collection] %}

      {% if collection.products.size > 0 %}
        <div class="featured-collection__grid">
          {% for product in collection.products limit: section.settings.products_to_show %}
            <div class="featured-collection__item">
              {% render 'product-card',
                product: product,
                show_vendor: section.settings.show_vendor,
                image_ratio: section.settings.image_ratio,
                lazy_load: forloop.index > 4
              %}
            </div>
          {% endfor %}
        </div>

        {% if section.settings.show_view_all %}
          <div class="featured-collection__cta text-center">
            <a href="{{ collection.url }}" class="btn btn--secondary">
              {{ section.settings.button_label }}
            </a>
          </div>
        {% endif %}
      {% else %}
        <div class="featured-collection__empty text-center">
          <p class="text-muted">This collection is empty.</p>
        </div>
      {% endif %}
    {% else %}
      <div class="featured-collection__empty text-center">
        <p class="text-muted">Select a collection to display.</p>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .featured-collection {
    padding: var(--spacing-4xl) 0;
  }

  .featured-collection__header {
    text-align: center;
    margin-bottom: var(--spacing-2xl);
  }

  .featured-collection__heading {
    margin-bottom: var(--spacing-sm);
  }

  .featured-collection__description {
    max-width: 600px;
    margin: 0 auto;
    color: var(--color-charcoal);
  }

  .featured-collection__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-2xl);
  }

  @media (min-width: 768px) {
    .featured-collection__grid {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-xl);
    }
  }

  @media (min-width: 1024px) {
    .featured-collection__grid {
      grid-template-columns: repeat(4, 1fr);
      gap: var(--spacing-2xl);
    }
  }

  .featured-collection__empty {
    padding: var(--spacing-4xl) 0;
  }
</style>

{% schema %}
{
  "name": "Featured Collection",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Products to Show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show Vendor",
      "default": false
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image Aspect Ratio",
      "options": [
        {
          "value": "4-5",
          "label": "Portrait (4:5)"
        },
        {
          "value": "1-1",
          "label": "Square (1:1)"
        },
        {
          "value": "4-3",
          "label": "Landscape (4:3)"
        }
      ],
      "default": "4-5"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View All' Button",
      "default": true
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "View All Products"
    }
  ],
  "presets": [
    {
      "name": "Featured Collection"
    }
  ]
}
{% endschema %}
