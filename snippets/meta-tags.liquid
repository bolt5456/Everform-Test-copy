{% comment %}
  Social Meta Tags (Open Graph, Twitter Card)
{% endcomment %}

{% liquid
  assign og_type = 'website'
  assign og_title = page_title
  assign og_description = page_description
  assign og_image = page_image
  assign og_image_alt = shop.name

  if current_tags
    assign tag_list = current_tags | join: ', '
    assign og_title = og_title | append: ' - ' | append: tag_list
  endif
  if current_page != 1
    assign og_title = og_title | append: ' - Page ' | append: current_page
  endif

  case template.name
    when 'product'
      assign og_type = 'product'
      if og_description == blank and product.description != blank
        assign og_description = product.description | strip_html | truncate: 160
      endif
      if og_image == blank and product.featured_media
        assign og_image = product.featured_media
        assign og_image_alt = product.featured_media.alt | default: product.title
      endif
    when 'collection'
      if og_description == blank and collection.description != blank
        assign og_description = collection.description | strip_html | truncate: 160
      endif
      if og_image == blank and collection.image
        assign og_image = collection.image
        assign og_image_alt = collection.title
      endif
    when 'article'
      assign og_type = 'article'
      if og_description == blank and article.excerpt != blank
        assign og_description = article.excerpt | strip_html | truncate: 160
      endif
      if og_image == blank and article.image
        assign og_image = article.image
        assign og_image_alt = article.title
      endif
  endcase

  if og_image == blank and settings.social_share_image != blank
    assign og_image = settings.social_share_image
  endif
%}

{%- comment -%}Open Graph meta tags{%- endcomment -%}
<meta property="og:site_name" content="{{ shop.name }}">
<meta property="og:url" content="{{ canonical_url }}">
<meta property="og:title" content="{{ og_title }}">
<meta property="og:type" content="{{ og_type }}">

{%- if og_description -%}
  <meta property="og:description" content="{{ og_description | escape }}">
{%- endif -%}

{%- if og_image -%}
  <meta property="og:image" content="https:{{ og_image | image_url: width: 1200 }}">
  <meta property="og:image:secure_url" content="https:{{ og_image | image_url: width: 1200 }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="{{ og_image_alt | escape }}">
{%- endif -%}

{%- comment -%}Twitter Card meta tags{%- endcomment -%}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ og_title }}">

{%- if settings.social_twitter != blank -%}
  <meta name="twitter:site" content="@{{ settings.social_twitter | remove: '@' }}">
{%- endif -%}

{%- if og_description -%}
  <meta name="twitter:description" content="{{ og_description | escape }}">
{%- endif -%}

{%- if og_image -%}
  <meta name="twitter:image" content="https:{{ og_image | image_url: width: 1200 }}">
  <meta name="twitter:image:alt" content="{{ og_image_alt | escape }}">
{%- endif -%}

{%- comment -%}Template-specific meta tags{%- endcomment -%}
{%- case template.name -%}
  {%- when 'product' -%}
    {%- assign current_variant = product.selected_or_first_available_variant -%}
    <meta property="og:price:amount" content="{{ current_variant.price | money_without_currency | remove: ',' }}">
    <meta property="og:price:currency" content="{{ shop.currency }}">
    {%- if product.available -%}
      <meta property="og:availability" content="instock">
    {%- else -%}
      <meta property="og:availability" content="outofstock">
    {%- endif -%}

  {%- when 'article' -%}
    <meta property="article:published_time" content="{{ article.published_at | date: '%Y-%m-%dT%H:%M:%SZ' }}">
    <meta property="article:author" content="{{ article.author }}">
    {%- for tag in article.tags -%}
      <meta property="article:tag" content="{{ tag }}">
    {%- endfor -%}
{%- endcase -%}
